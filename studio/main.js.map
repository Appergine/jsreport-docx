{"version":3,"sources":["webpack:///webpack/bootstrap 02e21087b9ceae2bd6ea","webpack:///./studio/main_dev.js","webpack:///./studio/DocxProperties.js","webpack:///external \"Studio.libraries['react']\"","webpack:///external \"Studio\""],"names":["Studio","addPropertiesComponent","Properties","title","entity","__entitySet","recipe","addApiSpec","template","docx","templateAsset","encoding","content","templateAssetShortid","previewListeners","push","request","entities","extensions","options","previewInOfficeOnline","getSettingValueByKey","setSetting","openModal","EntityRefSelect","removeInvalidReferences","props","onChange","updatedAssetItems","Object","keys","filter","k","shortid","length","_id","selected","references","data","assets","map","foundItems","selectAssets","e","name","Component"],"mappings":"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","file":"./studio/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 02e21087b9ceae2bd6ea\n **/","import Properties from './DocxProperties'\r\nimport Studio from 'jsreport-studio'\r\n\r\nStudio.addPropertiesComponent(Properties.title, Properties, (entity) => entity.__entitySet === 'templates' && entity.recipe === 'docx')\r\n\r\nStudio.addApiSpec({\r\n  template: {\r\n    docx: {\r\n      templateAsset: {\r\n        encoding: '...',\r\n        content: '...'\r\n      },\r\n      templateAssetShortid: '...'\r\n    }\r\n  }\r\n})\r\n\r\nStudio.previewListeners.push((request, entities) => {\r\n  if (request.template.recipe !== 'docx') {\r\n    return\r\n  }\r\n\r\n  if (Studio.extensions.docx.options.previewInOfficeOnline === false) {\r\n    return\r\n  }\r\n\r\n  if (Studio.getSettingValueByKey('office-preview-informed', false) === true) {\r\n    return\r\n  }\r\n\r\n  Studio.setSetting('office-preview-informed', true)\r\n\r\n  Studio.openModal(() => <div>\r\n    We need to upload your docx report to our publicly hosted server to be able to use\r\n    Office Online Service for previewing here in the studio. You can disable it in the configuration, see <a\r\n      href='https://jsreport.net/learn/docx' target='_blank'>https://jsreport.net/learn/docx</a> for details.\r\n  </div>)\r\n})\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/main_dev.js\n **/","import React, { Component } from 'react'\nimport Studio from 'jsreport-studio'\n\nconst EntityRefSelect = Studio.EntityRefSelect\n\nclass Properties extends Component {\n  static selectAssets (entities) {\n    return Object.keys(entities).filter((k) => entities[k].__entitySet === 'assets').map((k) => entities[k])\n  }\n\n  componentDidMount () {\n    this.removeInvalidReferences()\n  }\n\n  componentDidUpdate () {\n    this.removeInvalidReferences()\n  }\n\n  removeInvalidReferences () {\n    const { entity, entities, onChange } = this.props\n\n    if (!entity.docx) {\n      return\n    }\n\n    const updatedAssetItems = Object.keys(entities).filter((k) => entities[k].__entitySet === 'assets' && entities[k].shortid === entity.docx.templateAssetShortid)\n\n    if (updatedAssetItems.length === 0) {\n      onChange({ _id: entity._id, docx: null })\n    }\n  }\n\n  static title (entity, entities) {\n    if (!entity.docx || !entity.docx.templateAssetShortid) {\n      return 'docx'\n    }\n\n    const foundItems = Properties.selectAssets(entities).filter((e) => entity.docx.templateAssetShortid === e.shortid)\n\n    if (!foundItems.length) {\n      return 'docx'\n    }\n\n    return 'docx asset: ' + foundItems[0].name\n  }\n\n  render () {\n    const { entity, onChange } = this.props\n\n    return (\n      <div className='properties-section'>\n        <div className='form-group'>\n          <EntityRefSelect\n            headingLabel='Select docx template'\n            value={entity.docx ? entity.docx.templateAssetShortid : ''}\n            onChange={(selected) => onChange({ _id: entity._id, docx: selected.length > 0 ? { templateAssetShortid: selected[0].shortid } : null })}\n            filter={(references) => ({ data: references.assets })}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default Properties\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/DocxProperties.js\n **/","module.exports = Studio.libraries['react'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.libraries['react']\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = Studio;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio\"\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}